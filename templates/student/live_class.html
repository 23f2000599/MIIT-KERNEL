{% extends "base.html" %}

{% block title %}Live Classes{% endblock %}

{% block content %}
<div class="card">
    <h1>Live Learning Sessions ðŸŽ“</h1>
    <p>Join live classes and interactive sessions with your TAs</p>
</div>

{% if sessions %}
<div class="grid">
    {% for session in sessions %}
    <div class="card">
        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 1rem;">
            <h3>{{ session.title }}</h3>
            <span style="background: #27ae60; color: white; padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.8rem;">
                ðŸ”´ LIVE
            </span>
        </div>
        
        <p style="color: #666; margin-bottom: 1rem;">{{ session.description or 'Interactive learning session' }}</p>
        
        <div style="margin-bottom: 1rem;">
            <p><strong>Instructor:</strong> {{ session.ta.name }}</p>
            <p><strong>Duration:</strong> {{ session.duration or 60 }} minutes</p>
            <p><strong>Started:</strong> {{ session.start_time.strftime('%I:%M %p') if session.start_time else 'Just now' }}</p>
        </div>
        
        <div style="display: flex; gap: 0.5rem;">
            <button class="btn btn-success" onclick="joinSession({{ session.id }})">Join Session</button>
            <button class="btn" onclick="viewNotes({{ session.id }})">View Notes</button>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card" style="text-align: center;">
    <h3>No live sessions right now ðŸ“š</h3>
    <p>Check back later or request a session from your matched TAs</p>
    <a href="/student/matches" class="btn">View My TAs</a>
</div>
{% endif %}

<div class="card">
    <h3>ðŸ“… Upcoming Sessions</h3>
    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; margin: 1rem 0;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
            <strong>Advanced Calculus Review</strong>
            <span style="color: #3498db;">Tomorrow 3:00 PM</span>
        </div>
        <p style="margin: 0; color: #666;">with Sarah Johnson</p>
    </div>
    
    <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; margin: 1rem 0;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
            <strong>Physics Problem Solving</strong>
            <span style="color: #3498db;">Friday 2:00 PM</span>
        </div>
        <p style="margin: 0; color: #666;">with Mike Chen</p>
    </div>
</div>

<div class="card">
    <h3>ðŸŽ¯ Session Features</h3>
    <ul style="margin: 1rem 0; padding-left: 2rem;">
        <li>Real-time video and audio</li>
        <li>Interactive whiteboard</li>
        <li>Screen sharing capabilities</li>
        <li>Automatic note-taking</li>
        <li>Session recordings</li>
        <li>Q&A chat functionality</li>
    </ul>
</div>

<script>
function joinSession(sessionId) {
    // Simulate joining a live session
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
        background: rgba(0,0,0,0.8); display: flex; justify-content: center; 
        align-items: center; z-index: 1000;
    `;
    
    modal.innerHTML = `
        <div style="background: white; padding: 2rem; border-radius: 10px; max-width: 500px; text-align: center;">
            <h3>Joining Live Session...</h3>
            <div style="margin: 2rem 0;">
                <div style="width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
            </div>
            <p>Connecting to video session...</p>
            <button onclick="closeModal()" class="btn" style="margin-top: 1rem;">Cancel</button>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Simulate connection delay
    setTimeout(() => {
        modal.innerHTML = `
            <div style="background: white; padding: 2rem; border-radius: 10px; max-width: 600px;">
                <div style="background: #2c3e50; color: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; text-align: center;">
                    <h3>ðŸ”´ Live Session Active</h3>
                    <p>Advanced Calculus Review</p>
                </div>
                <div style="background: #34495e; height: 300px; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; margin-bottom: 1rem;">
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ“¹</div>
                        <p>Video feed would appear here</p>
                    </div>
                </div>
                <div style="display: flex; justify-content: center; gap: 1rem;">
                    <button class="btn">ðŸŽ¤ Mute</button>
                    <button class="btn">ðŸ“¹ Camera</button>
                    <button class="btn">âœ‹ Raise Hand</button>
                    <button class="btn btn-danger" onclick="closeModal()">Leave</button>
                </div>
            </div>
        `;
    }, 2000);
}

function viewNotes(sessionId) {
    alert(`Opening notes for session ${sessionId}...`);
}

function closeModal() {
    const modal = document.querySelector('div[style*="position: fixed"]');
    if (modal) modal.remove();
}

// Add CSS animation for loading spinner
const style = document.createElement('style');
style.textContent = `
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}